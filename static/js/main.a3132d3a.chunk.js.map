{"version":3,"sources":["App.js","index.js"],"names":["dummyList","range","map","value","index","id","uniqueId","type","random","height","App","useState","paddingTop","sliceStart","paddingBottom","info","setInfo","list","useMemo","slice","Math","max","ratioList","useRef","useEffect","debounceHandleScroll","debounce","event","console","log","current","findIndex","top","window","scrollY","sumTopValue","reduce","prev","curr","ratioValue","addEventListener","removeEventListener","className","style","VirtualItem","key","data-index","ref","node","clientHeight","clientWidth","offsetTop","FeedItem","fadeIn","keyframes","styled","motion","div","ItemA","ItemB","ItemC","ItemABox","aspectRatio","ItemBBox","ItemCBox","rootElement","document","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.a3132d3a.chunk.js","sourcesContent":["import { motion } from 'framer-motion';\nimport { random, range, uniqueId, debounce, throttle } from 'lodash-es';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport './styles.css';\n\nconst dummyList = range(50).map((value, index) => ({\n  index: index,\n  id: uniqueId(),\n  type: random(1, 3),\n  height: random(300, 900)\n}));\n\nexport default function App() {\n  // const [list, setList] = useState(dummyList.slice(0, 6));\n  // const [sliceStart, setSliceStart] = useState(0);\n  // const [paddingTop, setPaddingTop] = useState(0);\n  // const [paddingBottom, setPaddingBottom] = useState(300);\n  const [info, setInfo] = useState({\n    paddingTop: 0,\n    sliceStart: 0,\n    paddingBottom: 300\n  });\n  const list = useMemo(() => {\n    return dummyList.slice(\n      Math.max(info.sliceStart - 1, 0),\n      Math.max(info.sliceStart + 3, 6)\n    );\n  }, [info]);\n\n  const ratioList = useRef([]);\n\n  // const presentList = useM\n  useEffect(() => {\n    // let scrollTime = 0;\n    const handleScroll = (event) => {\n      console.log(event);\n      const index = ratioList.current.findIndex(\n        (value) => value.top > window.scrollY + 50\n      );\n      const sumTopValue = ratioList.current\n        .slice(0, Math.max(index - 1, 0))\n        .reduce((prev, curr) => {\n          return prev + curr.ratioValue;\n        }, 0);\n      setInfo({\n        paddingTop: sumTopValue,\n        sliceStart: index\n      });\n    };\n    const debounceHandleScroll = debounce(handleScroll, 10);\n    window.addEventListener('scroll', debounceHandleScroll);\n    return () => {\n      window.removeEventListener('scroll', debounceHandleScroll);\n    };\n  }, []);\n  return (\n    <div className=\"App\">\n      <section\n        style={{\n          paddingTop: `${info.paddingTop}%`,\n          paddingBottom: `${info.paddingBottom}%`\n        }}\n      >\n        {list.map((value) => (\n          <VirtualItem\n            key={value.id}\n            data-index={value.index}\n            ref={(node) => {\n              if (node) {\n                const ratioValue = (node.clientHeight / node.clientWidth) * 100;\n                const top = node.offsetTop;\n                ratioList.current[value.index] = { ratioValue, top, node };\n              }\n            }}\n          >\n            <FeedItem\n              type={value.type}\n              height={value.height}\n              id={value.index}\n            />\n          </VirtualItem>\n        ))}\n      </section>\n    </div>\n  );\n}\nconst fadeIn = keyframes`\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n`;\nconst VirtualItem = styled(motion.div)`\n  animation: ${fadeIn} 0.2s cubic-bezier(0.215, 0.61, 0.355, 1) both;\n`;\n\nfunction FeedItem({ type, height, id }) {\n  switch (type) {\n    case 1:\n      return <ItemA height={height} id={id} />;\n    case 2:\n      return <ItemB height={height} id={id} />;\n    case 3:\n      return <ItemC height={height} id={id} />;\n    default:\n      return null;\n  }\n}\n\nconst ItemABox = styled.div`\n  padding: 60px;\n  background: blanchedalmond;\n`;\nfunction ItemA({ height, id }) {\n  return (\n    <ItemABox>\n      <div style={{ aspectRatio: `600 / ${height}` }}>\n        {id}\n        {/* <img\n          width=\"100%\"\n          src={`https://source.unsplash.com/category/nature/600x${height}`}\n          alt=\"nature\"\n        /> */}\n      </div>\n    </ItemABox>\n  );\n}\n\nconst ItemBBox = styled.div`\n  padding: 30px;\n  background: red;\n`;\n\nfunction ItemB({ height, id }) {\n  return (\n    <ItemBBox>\n      <div style={{ aspectRatio: `600 / ${height}` }}>\n        {id}\n        {/* <img\n          width=\"100%\"\n          src={`https://source.unsplash.com/category/nature/600x${height}`}\n          alt=\"nature\"\n        /> */}\n      </div>\n    </ItemBBox>\n  );\n}\n\nconst ItemCBox = styled.div`\n  padding: 17px;\n  background: green;\n`;\n\nfunction ItemC({ height, id }) {\n  return (\n    <ItemCBox>\n      <div style={{ aspectRatio: `600 / ${height}` }}>\n        {/* <img\n          width=\"100%\"\n          src={`https://source.unsplash.com/category/nature/600x${height}`}\n          alt=\"nature\"\n        /> */}\n        {id}\n      </div>\n    </ItemCBox>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}